<svg #plot
  [style.fontFamily]="plotOptions.fontFamily"
  [style.fontSize]="(plotOptions.fontSize * 18).toString() + 'px'"
  [attr.class]="name" [attr.width]="fixedWidth" [attr.height]="fixedHeight"
  [attr.viewBox]="viewBox">

  <rect #unit x="0" y="0" width="1em" height="1em" stroke="none" fill="none" />
  <ng-template [ngIf]="groups && project">
    <text text-anchor="middle"
      [attr.x]="innerWidth / 2 + leftMargin"
      [attr.y]="height - 5">
      Parameter Space
    </text>
    <text text-anchor="middle" font-weight="bold"
      [attr.x]="innerWidth / 2 + leftMargin"
      [attr.y]="(plotOptions.getFontSize() / 2) + 8">
      {{title}}
    </text>

    <!--
    <circle r="5" [attr.cx]="xScale(0)" [attr.cy]="yScale(0.5)"
      [attr.transform]="translate(leftMargin, topMargin)"
      fill="darkseagreen" />
    -->

    <g *ngFor="let group of groups; let i = index; trackBy: trackByGroupId"
      [id]="group.id">

      <path id="{{group.id}}-dist"
        [attr.fill]="group.color"
        [attr.fill-opacity]="group.fillOpacity"
        stroke="none" />

      <path id="{{group.id}}-center"
        [attr.stroke]="group.color"
        [attr.stroke-width]="plotOptions.lineWidth * 3"
        fill="none" />

      <path id="{{group.id}}-left"
        [class.draggable]="group.primary && !disableDragCI"
        [attr.stroke]="group.color"
        [attr.stroke-width]="plotOptions.lineWidth * 3"
        fill="none"
        (mouseover)="group.primary ? toggleLeftBarInfo(true) : null"
        (mouseout)="group.primary ? toggleLeftBarInfo(false) : null" />

      <path id="{{group.id}}-right"
        [class.draggable]="group.primary && !disableDragCI"
        [attr.stroke]="group.color"
        [attr.stroke-width]="plotOptions.lineWidth * 3"
        fill="none"
        (mouseover)="group.primary ? toggleRightBarInfo(true) : null"
        (mouseout)="group.primary ? toggleRightBarInfo(false) : null" />

      <circle id="{{group.id}}-target"
        [class.draggable]="group.primary && !disableDragTarget"
        r="5"
        [attr.fill]="group.color"
        (mouseover)="group.primary ? toggleTargetInfo(true) : null"
        (mouseout)="group.primary ? toggleTargetInfo(false) : null" />
    </g>

    <g *ngIf="showLeftBarInfo"
      [attr.transform]="translate(leftMargin + xScale(mainGroup.left), topMargin + yScale(0.5))">
      <path id="{{name}}-left-box"
        stroke="black" stroke-width="1" fill="white" fill-opacity="0.9" />
      <text id="{{name}}-left-coords" x="0" y="-3em" font-family="monospace" text-anchor="middle">
        <tspan style="white-space: pre">{{mainGroup.label}}: {{ciWidth() | formatFixed:[mainGroup.left]}}</tspan><tspan x="0" dy="1em" style="white-space: pre"> Bound: {{mainGroup.left | formatFixed:[ciWidth()]}}</tspan>
      </text>
    </g>

    <g *ngIf="showRightBarInfo"
      [attr.transform]="translate(leftMargin + xScale(mainGroup.right), topMargin + yScale(0.5))">
      <path id="{{name}}-right-box"
        stroke="black" stroke-width="1" fill="white" fill-opacity="0.9" />
      <text id="{{name}}-right-coords" x="0" y="-3em" font-family="monospace" text-anchor="middle">
        <tspan style="white-space: pre">{{mainGroup.label}}: {{ciWidth() | formatFixed:[mainGroup.right]}}</tspan><tspan x="0" dy="1em" style="white-space: pre"> Bound: {{mainGroup.right | formatFixed:[ciWidth()]}}</tspan>
      </text>
    </g>

    <g *ngIf="showTargetInfo"
      [attr.transform]="translate(leftMargin + xScale(mainGroup.target), topMargin + yScale(0.5))">
      <path id="{{name}}-target-box"
        stroke="black" stroke-width="1" fill="white" fill-opacity="0.9" />
      <text id="{{name}}-target-coords" x="0" y="-1.5em" font-family="mono" text-anchor="middle">
        <tspan style="white-space: pre">&delta;: {{mainGroup.target | formatFixed:[]}}</tspan>
      </text>
    </g>

    <g id="{{name}}-bottom-axis" [attr.transform]="translate(leftMargin, innerHeight + topMargin)"></g>
  </ng-template>
</svg>
