<form (ngSubmit)="onSubmit()" #startForm="ngForm">
  <div class="form-group">
    <label for="output">
      What do you want to know?
      <button type="button" class="btn btn-secondary fa fa-question-circle"
        (click)="toggleHelp()"></button>
    </label>
    <select class="form-control" id="output"
            required
            [(ngModel)]="model.output" name="output">
      <option></option>
      <option value="n">Sample size by Power</option>
      <option value="nByCI">Sample size by 95% CI</option>
      <option value="power">Power</option>
      <option value="delta">Detectable alternative</option>
    </select>
  </div>
  <!--
  <div class="form-group" *ngIf="model.output">
    <label for="design">Paired or independent?</label>
    <select class="form-control" id="design"
            required
            [(ngModel)]="model.design" name="design">
      <option></option>
      <option>Paired</option>
      <option>Independent</option>
    </select>
  </div>
  -->
  <div *ngIf="model.output">
    <div class="form-group">
      <label for="alpha">
        Type I Error (&alpha;)
        <i class="fa fa-info-circle" aria-hidden="true"
          [ngbPopover]="alphaHelp" popoverTitle="Type I Error (&alpha;)"
          placement="right" triggers="hover" container="body"></i>
      </label>
      <ng-template #alphaHelp>
        The Type I error probability for a two sided test. This is the
        probability that we will falsely reject the null hypothesis.
      </ng-template>
      <input class="form-control" id="alpha"
             type="number" step="0.01"
             required
             [(ngModel)]="model.alpha" name="alpha">
    </div>
    <div class="form-group">
      <label for="sigma">
        Standard deviation (&sigma;)
        <i class="fa fa-info-circle" aria-hidden="true"
          [ngbPopover]="sigmaHelp" popoverTitle="Standard deviation (&sigma;)"
          placement="right" triggers="hover" container="body"></i>
      </label>
      <ng-template #sigmaHelp>
        For independent tests σ is the within group standard deviation. For
        paired designs it is the standard deviation of difference in the
        response of matched pairs.
      </ng-template>
      <input class="form-control" id="sigma"
             type="number" step="0.1"
             required
             [(ngModel)]="model.sigma" name="sigma">
    </div>
    <div *ngIf="needDelta()" class="form-group">
      <label for="delta">Difference in population means (&delta;)</label>
      <input class="form-control" id="delta"
             type="number" step="0.1"
             required
             [(ngModel)]="model.delta" name="delta">
    </div>
    <div *ngIf="needPower()" class="form-group">
      <label for="power">
        Power
        <i class="fa fa-info-circle" aria-hidden="true"
          [ngbPopover]="powerHelp" popoverTitle="Power"
          placement="right" triggers="hover" container="body"></i>
      </label>
      <ng-template #powerHelp>
        For independent tests power is probability of correctly rejecting the
        null hypothesis of equal population means given n experimental
        patients, m control patients per experimental patient, a Type I error
        probability α and a true difference in population means of δ. For
        paired tests it is the probability of correctly rejecting the null
        hypothesis of equal population means given n pairs of patients, a Type
        I error probability α and a true difference in population means of δ.
      </ng-template>
      <input class="form-control" id="power"
             type="number" step="0.01"
             required
             [(ngModel)]="model.power" name="power">
    </div>
    <div *ngIf="needCI()" class="form-group">
      <label for="ci">95% confidence interval width</label>
      <input class="form-control" id="ci" type="number" required
             [(ngModel)]="model.ci" name="ci">
    </div>
    <ng-template [ngIf]="needNOrCI()">
      <div class="form-check form-check-inline">
        <label class="form-check-label">
          <input class="form-check-input" type="radio"
                 name="ciMode" id="ciMode-false"
                 [(ngModel)]="model.ciMode" [value]="false">
          Sample size
          <i class="fa fa-info-circle" aria-hidden="true"
            [ngbPopover]="nHelp" popoverTitle="Sample size"
            placement="right" triggers="hover" container="body"></i>
        </label>
        <label class="form-check-label">
          <input class="form-check-input" type="radio"
                 name="ciMode" id="ciMode-true"
                 [(ngModel)]="model.ciMode" [value]="true">
          95% confidence interval width
        </label>
      </div>
      <ng-template #nHelp>
        For independent t-tests n is the number of experimental subjects. For
        pair test n is the number of pairs.
      </ng-template>

      <div class="form-group">
        <input *ngIf="!model.ciMode"
               class="form-control" id="n"
               type="number"
               required
               [(ngModel)]="model.n" name="n">
        <input *ngIf="model.ciMode"
               class="form-control" id="ci"
               type="number"
               required
               [(ngModel)]="model.ci" name="ci">
      </div>

    </ng-template>
    <ng-template [ngIf]="needPowerOrDelta()">
      <div class="form-check form-check-inline">
        <label class="form-check-label">
          <input class="form-check-input" type="radio"
                 name="deltaMode" id="deltaMode-false"
                 [(ngModel)]="model.deltaMode" [value]="false">
          Power
        </label>
        <label class="form-check-label">
          <input class="form-check-input" type="radio"
                 name="deltaMode" id="deltaMode-true"
                 [(ngModel)]="model.deltaMode" [value]="true">
          Difference in population means (&delta;)
        </label>
      </div>

      <div class="form-group">
        <input *ngIf="!model.deltaMode"
               class="form-control" id="power"
               type="number"
               required
               [(ngModel)]="model.power" name="power">
        <input *ngIf="model.deltaMode"
               class="form-control" id="delta"
               type="number"
               required
               [(ngModel)]="model.delta" name="delta">
      </div>

    </ng-template>
    <button type="submit" class="btn btn-success"
            [disabled]="!startForm.form.valid">
      Calculate
    </button>
  </div>
</form>
