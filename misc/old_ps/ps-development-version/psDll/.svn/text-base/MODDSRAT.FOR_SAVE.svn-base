	SUBROUTINE MODDSRATIO[dllexport]
     . (ALPHA,POWER,PHI,P0,N,M,resultPSI)
!MS$ATTRIBUTES REFERENCE :: resultPSI
	IMPLICIT NONE

	REAL ALPHA,POWER,PHI,P0,N,M,resultPSI
C
C-Description-----------------------------------------------------------
C
C  Function:
C	Determine the value of the odds ratio that can be detected
C	with power 1-BETA from a matched case-control study.
C	
C  Input prompted for from user:
C	ALPHA	Type I error probability for a two sided test
C	POWER	The desired statistical power
C	PHI		Correlation coefficient
C	P0		Probability of exposure in control group
C	N		Number of case patients
C	M		Number of matched controls per case patient
C
C  Output:
C	PSI	Odds ratio
C		-or-
C       -1 if the power associated with the odds ratio (100.) is less
C		   than 1-BETA.
C				or
C       -2 if no odds ratio exists with the required power given P0 and R.
C				or
C       -3 if N is too small to permit valid normal approximations.
C
C  Notes:
C   .	This routine was written by Dale Plummer.
C   .	Reference:
C	    Dupont, WD: "Power Calculations for Matched Case-Control
C	    Studies", Biometrics, 1988; 44:1157-1168
C   .	Link with subroutines in file SUBS.FOR
C
C-Declarations----------------------------------------------------------
C
C  Locals
C
        REAL BETA,PSIMAX
        INTEGER IM,IN
C
C-Code------------------------------------------------------------------
C
	IM=M
	IN=N
	BETA=1.-POWER
	PSIMAX=100.
C
C    Call the working routine.
C
	CALL TUPPOW(ALPHA,BETA,IN,IM,P0,PHI,PSIMAX,.00001,resultPSI)
	RETURN
	END